10 REM PRIM-1.BAS MATRICULACION DE PRINERO
20 NORMAL: HOME
30 OPEN "R",#1,"B:CURSO.FCH",7
40 FIELD#1,7 AS CUR$
50 GET#1,1
60 IF CUR$<>"PRIMERO" THEN GOSUB 1250: CLOSE:GOTO 20
70 CLOSE
80 GOSUB 1320
90 PRI$="S": REM ******* CONECTAR IMPRESORA : PRI$="S" ***********
100 REM LISTADOS DE ALUMNOS
110 NORMAL: HOME
120 VTAB (3) :HTAB (20) :INVERSE:PRINT "LISTADOS DE ALUMNOS"
130 VTAB (8):HTAB (25) :INVERSE:PRINT "G";:NORMAL:PRINT ".- POR GRUPOS DE CLASE"
140 VTAB (10) :HTAB (25) :INVERSE:PRINT "T";:NORMAL:PRINT ".- LISTADO TOTAL"
150 VTAB (12):HTAB (25) :INVERSE:PRINT "P";:NORMAL:PRINT ".- POR PARAMETROS"
160 VTAB (14) :HTAB (25) :INVERSE:PRINT "A";:NORMAL:PRINT ".- ACABAR LISTADOS"
170 VTAB (18):HTAB (20) :PRINT "ELIJA LA OPCION --> ";
180 GOSUB 1400:IF S$<>"G" AND S$<>"T" AND S$<>"P" AND S$<>"A" THEN 170
190 IF S$="A" THEN CLOSE:RUN "PRIMERO.BAS"
200 GET#3,1:IF CLA$<>"S" THEN GOSUB 1030
210 IF S$="P" THEN 1010
220 IF S$="T" THEN 590
230 VTAB (8) :HTAB (25) :INVERSE: PRINT "G.- POR GRUPOS DE CLASE" :NORMAL
240 VTAB (19) :HTAB (20) :PRINT "QUE GRUPO QUIERE LISTAR (A-Z) : ";
250 GOSUB 1400:IF (S$<"A" OR S$>"Z") AND S$<>" " THEN 240
260 NORMAL :HOME
270 IF PRI$="S" THEN GOSUB 490
280 INVERSE:PRINT "I.B. J I M E N E Z   D E   L A   E S P A D A";:NORMAL:PRINT "           (CARTAGENA) " :PRINT :PRINT
290 PRINT "          P R I M E R O   D E   B.U.P.        GRUPO  " ;S$:PRINT
300 PRINT "NU.  REP  NU.F.     N O M B R E                        IDI. RE/ET"
310 PRINT "==== === ====== ====================================== ==== ====="
320 Q=0
330 GET#3, 1 :N%=VAL(FIC$)
340 FOR I=1 TO N%
350 GET#2,I: V=VAL(ORD$)
360 GET#1 ,V: IF S$<>GRU$ OR INSTR(NOM$,"%")<>0 THEN 440
370 P$="UNO":IF PAR$="2" THEN P$="DOS"
380 Q=Q+1:R$="( )":IF REP$="S" THEN R$="(R)"
390 I$=" "+IDI$:IF SEG$="S" THEN I$="IF"
400 IF FRAC$="S" THEN PRINT USING "#### ";Q;:PRINT R$;:PRINT USING " (####) ";V;:PRINT NOM$;"  (PARCIAL ";P$;")":GOTO 430
410 IF SUES$="S" THEN PRINT USING "#### ";Q;:PRINT R$;:PRINT USING " (####) ";V;:PRINT NOM$;" ASIG. SUELTAS :  ";SU1$;" ";SU2$:GOTO 430
420 PRINT USING "#### ";Q;:PRINT R$;:PRINT USING " (####) ";V;: PRINT NOM$;"    ";I$;"    ";REL$
430 IF PRI$="S" THEN GOSUB 560
440 NEXT I
450 IF PRI$="S" THEN FOR J=I TO 60:LPRINT:NEXT J
460 IF INKEY$<>"" THEN 460
470 IF INKEY$<>CHR$(27) THEN 470
480 GOTO 100
490 LPRINT CHR$(27) ;"<";CHR$(27);"A"
500 WIDTH LPRINT 80:LPRINT CHR$(27);"N";
510 LPRINT CHR$(27) ;"!" ;CHR$(14);"I.B. JIMENEZ DE LA ESPADA";CHR$(15);CHR$(27);CHR$(34);"          (CARTAGENA) ":LPRINT :LPRINT
520 LPRINT "     P R I M E R O   D E   B.U.P.           GRUPO ";S$:LPRINT
530 LPRINT "NU.  REP NU.F.      NOMBRE                            IDI. RE/ET"
540 LPRINT "==== === ====== ===================================== ==== ====="
550 RETURN
560 IF FRAC$="S" THEN LPRINT USING "#### ";Q;:PRINT R$;:LPRINT USING " (####) ";V;:LPRINT NOM$;"  (PARCIAL ";P$;")":RETURN
570 IF SUES$="S" THEN LPRINT USING "#### ";Q;:PRINT R$;:LPRINT USING " (####) ";V;:LPRINT NOM$;" ASIG. SUELTAS :  ";SU1$;" ";SU2$:RETURN
580 LPRINT USING "#### ";Q;:LPRINT R$;:LPRINT USING " (####) ";V;: LPRINT NOM$;"    ";I$;"    ";REL$:RETURN
590 VTAB (10):HTAB (25):INVERSE:PRINT "T.- LISTADO TOTAL":NORMAL
600 VTAB (18) :HTAB (20) :PRINT "DIURNO-NOCTURNO (D=DIURN./N=NOCT./A=AMBOS) : ";
610 GOSUB 1400: IF S$<>"N" AND S$<>"D" AND S$<>"A" THEN 600
620 NORMAL : HOME
630 INVERSE:PRINT "I.B. J I M E N E Z   D E   L A   E S P A D A";:NORMAL:PRINT "         (CARTAGENA)" :PRINT: PRINT
640 PRINT "   A L U M N O S   D E   P R I M E R O    ";
650 IF S$="0" THEN PRINT "DIURNO" ELSE IF S$="N" THEN PRINT "NOCTURNO" ELSE PRINT "DIURNO Y NOCTURNO"
660 PRINT
670 PRINT "NU.  REP  NU.F.       N O M B R E                      IDI. RE/ET APA EDAD GRUPO"
680 PRINT "==== === ====== ====================================== ==== ===== === ==== ====="
690 IF PRI$="S" THEN GOSUB 890
700 Q=0
710 GET#3,1 :N%=VAL(FIC$)
720 FOR I=1 TO N%
730 GET#2,I:V=VAL(ORD$)
740 GET#1 ,V:IF S$="A" THEN 760
750 IF S$<>DIU$ THEN 850
760 IF INSTR(NOM$,"%")<>0 THEN 850
770 P$="UNO": IF PAR$="2" THEN P$="DOS"
780 Q=Q+1:R$="( )":IF REP$="S" THEN R$="(R)"
790 I$=" "+IDI$:IF SEG$="S" THEN I$="IF"
800 IF FRAC$="S" THEN PRINT USING "#### ";Q;:PRINT R$;:PRINT USING " (####) ";V;:PRINT NOM$;"  (PAR. ";P$;")  ";APA$;"   ";EDAD$;"    ";GRU$:GOTO 840
810 IF SUE$="S" THEN  PRINT USING "#### ";Q;:PRINT R$;:PRINT USING " (####) ";V;:PRINT NOM$;"  (SUELTAS)   ";APA$;"   ";EDAD$;"    ";GRU$:GOTO 840
820 PRINT USING "#### ";Q;:PRINT R$;:PRINT USING " (####) ";V;:PRINT NOM$;"    ";I$;"   ";REL$;"    ";APA$;"   " EDAD$;"    ";GRU$
830 IF INKEY$=CHR$(27) THEN 100
840 IF PRI$="S" THEN GOSUB 980
850 NEXT I
860 IF INKEY$<>"" THEN 860
870 IF INKEY$<>CHR$(27) THEN 870
880 GOTO 100
890 LPRINT CHR$(27) ;"<";CHR$(27);"A";CHR$(27);"N";
900 WIDTH LPRINT 160
910 LPRINT CHR$(27) ;"!" ;CHR$(14);"I.B. JIMENEZ DE LA ESPADA";CHR$(15);CHR$(27);CHR$(34);"          (CARTAGENA) ":LPRINT :LPRINT CHR$(27);"Q"
920 LPRINT "A L U M N O S   D E   P R I M E R O      ";
930 IF S$="D" THEN LPRINT "DIURNO" ELSE IF S$="N" THEN LPRINT "NOCTURNO" ELSE LPRINT "DIURNO Y NOCTURNO"
940 LPRINT
950 LPRINT "NU.  REP NU.F.      N O M B R E                        IDI. RE/ET APA EDAD GRUPO"
960 LPRINT "==== === ====== ====================================== ==== ===== === ==== ====="
970 RETURN
980 IF SUE$="S" THEN LPRINT USING "#### ";Q;:LPRINT R$;:LPRINT USING " (####) ";V;:LPRINT NOM$;"   (SUELTAS)    ";APA$;"   ";EDAD$;"    ";GRU$: RETURN
990 IF FRAC$="S" THEN LPRINT USING "#### ";Q;:LPRINT R$;:LPRINT USING " (####) ";V;:LPRINT NOM$;"   (PAR. ";P$;")   ";APA$;"   ";EDAD$;"    ";GRU$: RETURN
1000 LPRINT USING "#### ";Q;:LPRINT R$; :LPRINT USING " (####) ";V;:LPRINT NOM$; "    ";I$;"     ";REL$;"    ";APA$;"   ";EDAD$;"    ";GRU$: RETURN
1010 VTAB (12):HTAB (25) :INVERSE:PRINT "P.- POR PARAMETROS" :NORMAL
1020 CLOSE:RUN "PRIM-3.BAS"
1030 REM ORDENACION ALFABETICA
1040 DIM IN%(700) ,NOMBRE$ (700)
1050 GET#3,1 :N%=VAL(FIC$):IF IN%>690 THEN HOME:VTAB (10):HTAB (15):INVERSE:PRINT "LLAMAR AL PROGRAMADOR.FALTA ESTRUCTURA" :NORMAL :END
1070 VTAB (18):HTAB (20): INVERSE:PRINT "CLASIFICANDO ...";:NORMAL:PRINT "           "
1080 M=N%
1090 M=INT(M/2)
1100 IF M=0 THEN 1210
1110 K=N%-M:J=1
1120 N=J
1130 L=N+M
1140 IF NOMBRE$(N) <=NOMBRE$(L) THEN 1180
1150 SWAP NOMBRE$(N),NOMBRE$(L)
1160 SWAP IN%(N), IN%(L)
1170 N=N-M:IF N>=1 THEN 1130 THEN 1130
1180 J=J+1
1190 IF J>K THEN 1090
1200 GOTO 1120
1210 FOR I=1 TO N%:LSET ORD$=STR$(IN%(I)): PUT#2,I :NEXT I
1220 LSET CLA$="S" :PUT#3,1
1230 ERASE IN%,NOMBRE$
1240 RETURN
1250 REM DISCO MAL COLOCADO
1260 PRINT CHR$(7);CHR$(7)
1270 VTAB (10):HTAB (10) :INVERSE:PRINT "POR FAVOR, COLOQUE EL DISCO DE PRIMERD EN LA UNIDAD ‘B"
1280 VTAB (12):HTAB (30) :PRINT "PULSE [RETURN]"
1290 IF INKEY$<>"" THEN 1290
1300 IF INKEY$<>CHR$(13) THEN 1300
1310 RETURN
1320 REM DEFINICION DE FICHEROS
1330 OPEN "R",#1,"B:PRIMERO.FCH" ,54
1340 FIELD#1,35 AS NOM$,2 AS EDAD$,1 AS SEXO$,1 AS REP$,1 AS IDI$,1 AS DIU$,1 AS REL$,1 AS APA$,1 AS GRU$,1 AS SEG$,1 AS FRAC$, 1 AS PAR$,1 AS SUE$,3 AS SU1$,3 AS SU2$
1350 OPEN "R",#2,"B:PRIMERO.NDX", 4
1360 FIELD#2,4 AS ORD$
1370 OPEN "R",#3,"B:PRIMERO.ORD" ,5
1380 FIELD#3,4 AS FIC$,1 AS CLA$
1390 RETURN
1400 REM ENTRADA SIMPLE
1410 S$=INKEY$:IF S$<CHR$(32) OR S$>"Z" THEN 1410
1420 PRINT S$
1430 RETURN
1440 REM ENTRADA MULTIPLE
1450 P=0
1460 S$=""
1470 E$=INKEY$:IF E$="" THEN 1470
1480 IF E$=CHR$(13) THEN RETURN
1490 IF E$=CHR$(8) AND LEN(S$)>0 THEN HTAB (POS(0)-1):PRINT " ";:HTAB (POS(0)-1):P=P=1 :S$=LEFT$(S$,LEN(S$)-1):GOTO 1470
1500 IF E$=CHR$(27) AND I=0 THEN RETURN
1510 IF (E$<" " OR E$>"Z") AND E$<>"ñ" AND E$<>"Ñ" THEN 1470
1520 IF P>=L% THEN 1470
1530 P=P+1:S$=S$+E$:PRINT E$; :GOTO 1470
